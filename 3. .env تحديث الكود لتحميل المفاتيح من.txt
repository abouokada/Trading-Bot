from telegram.ext import Updater, CommandHandler
from telegram import Bot
from dotenv import load_dotenv
import os

# ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ù…Ù† Ù…Ù„Ù .env
load_dotenv()

# Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ù…Ù† Ø§Ù„Ø¨ÙŠØ¦Ø©
TOKEN = os.getenv("TELEGRAM_TOKEN")
CHAT_ID = os.getenv("TELEGRAM_CHAT_ID")

# Ø¯Ø§Ù„Ø© Ù„ØªÙ†ÙÙŠØ° Ø£Ù…Ø± /start
def start(update, context):
    user = update.message.from_user
    update.message.reply_text(f"Ù…Ø±Ø­Ø¨Ù‹Ø§ {user.first_name}! ğŸ‘‹\nØ£Ù†Ø§ Ø¨ÙˆØª Ø§Ù„ØªØ¯Ø§ÙˆÙ„ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ. ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ Ø§Ù„ÙŠÙˆÙ…ØŸ")
    send_telegram_notification("Ø¨ÙˆØª Ø§Ù„ØªØ¯Ø§ÙˆÙ„ ÙŠØ¹Ù…Ù„ Ø§Ù„Ø¢Ù†!")

# Ø¯Ø§Ù„Ø© Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± Ø¥Ù„Ù‰ Ø§Ù„Ù€ Chat ID
def send_telegram_notification(message):
    bot = Bot(TOKEN)
    bot.send_message(chat_id=CHAT_ID, text=message)

# Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø¨ÙˆØª
def main():
    # Ø¥Ù†Ø´Ø§Ø¡ Updater Ù…Ø¹ Ø§Ù„ØªÙˆÙƒÙ† Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ø¨ÙˆØª
    updater = Updater(TOKEN, use_context=True)

    # Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø­Ø¯Ø«Ø§Øª
    dispatcher = updater.dispatcher

    # Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ø§Ù„Ø¬ Ù„Ø£Ù…Ø± /start
    dispatcher.add_handler(CommandHandler("start", start))

    # Ø¨Ø¯Ø¡ Ø§Ù„Ø¨ÙˆØª
    updater.start_polling()

    # Ø§Ø¬Ø¹Ù„ Ø§Ù„Ø¨ÙˆØª ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ Ù…Ø³ØªÙ…Ø±
    updater.idle()

if __name__ == '__main__':
    main()
